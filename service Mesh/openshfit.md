

# 컨테이너 기술과 가상화 기술 비교

## 가상화 기술의 고질적인 문제점

| 거대한 이미지 사이즈                                         | 느린 시작 시간                                               | VM간의 환경 불일치                                           |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| VM을 템플릿 관리하지만 이미지의 사이가 커서 재사용성을 높이기 어려움 | 부팅시 Hypervisor - OS - 미들웨어 - 애플리케이션 까지 실행되어야 함 | VM 생썽  후 개별로 변경사항을 관리하기 때문에 VM간 구성이나 환결이 불일치 |

```
가상 머신은  Guest OS 에  BIOS, 가상 CPU, 가상 메모리, 가상 디스크, 가상 NIC 등을 제공하여 마치 물리서버에서 실행되는 것처럼 보입니다.

이 때문에 게스트 OS 입장에서는  OS 시작과 정지 등의 운영에 있어서 물리서버와 아무런 차이점 없이 운용이 가능합니다.

가상화 기술은 가상머신 이미지마다 OS (게스트 OS)가 필요합니다. 이로인하여 OS 에 대한 라이선스가 필요합니다.

또한 운영하면서 가상머신의 OS 별로 차이점이 발생하게 되고 이로 인하여 운영관리의 어려움이 증가하게 됩니다.

시간에 따라 이미지 사이즈가 증가하면서 마이그레이션에 대한 부담도 커지게 됩니다.
```



## 컨테이너 를 통한 가상화 기술의 문제점 해결

| 작은 이미지 사이즈                                           | 빠른 시작 시간                  | 높은 이동성                                                  |
| ------------------------------------------------------------ | ------------------------------- | ------------------------------------------------------------ |
| 컨테이너는 레이어 개념으로 이미지에 파일을 추가/삭제 하여 관리 | 컨테이너는 격리된 프로세스 형태 | 어플리케이션과 필수 및 의존  라이브러리 파일을 이미지에 포함 |
| 레이어사이즈를 최적화하여 이미지 사이즈 관리                 | 부팅과정 필요없음               | 환경 파편화를 막을 수 있음                                   |

```
컨테이너는 이와 달리 OS를 가상화하여 여러 개의 컨테이너를 OS 커널에서 직접 실행합니다. 컨테이너는 기존의 가상화 기술보다 훨씬 가볍게 동작하며, OS 커널을 공유하고, 시작 시간이나 종료 시간이 빠르고 ,  메모리를 훨씬 적게 차지합니다.

컨테이너는 가상 머신과 마찬가지로 애플리케이션을 관련 라이브러리 및 종속 항목과 함께 패키지로 묶어 소프트웨어 서비스를 위한 환경을 분리할 수 있도록 해줍니다. 가상화 기술과 컨테이너 기술이  유사점은 여기까지입니다. 컨테이너를 사용하면 개발자와 IT 운영팀이 훨씬 작은 단위로 업무를 수행할 수 있어이점이 훨씬 많습니다.

하이퍼 바이저 형 가상화와 컨테이너 기술를 비교하면 컨테이너는 OS가 포함되지 않아 크기가 작고, 고속으로 시작과 정지 합니다.
```



|                    | **하이퍼 바이저 형 가상화**                                  | **컨테이너 형 가상화**                                       |
| :----------------- | :----------------------------------------------------------- | ------------------------------------------------------------ |
| 시작 시간          | 몇 분                                                        | 몇 초                                                        |
| 이미지 크기        | 수 GB ~ 수백 GBOS를 포함하여 애플리케이션과 필요한 런타임 소프트웨어 | ~ 수백 MB애플리케이션과 런타임 소프트웨어만                  |
| Guest OS           | Windows/Linux 등 다양한 선택 가능                            | 호스트 OS 와 동일한 OS                                       |
| 이식성             | 대부분 가상 이미지에 대한 변환이 필요함                      | 컨테이너 이미지 그대로 사용 가능                             |
| 데이터 관리        | VM 내부또는 연결된 스토리지에 저장                           | 컨테이너 내부에 있는 데이터는 종료시 소멸되며, 필요에 따라 스토리지를 이용하여 저장 |
| Guest OS 와의 관계 | Guest OS는 하드웨어(가상)로 인식                             | Host OS를 커널 수준으로 분리하여 OS를 가상화 형태로 사용하여 필요에 따라 호스트와 리소스 공유 가능 |

![hyvsco](/Users/jaesuk.lee/Documents/GitHub/openshift4/service Mesh/image/hyvsco.png)



# 컨테이너 기술의 필요성 

## 컨테이너 기술의 장점

```
가상 머신은 하드웨어 스택을 가상화합니다. 컨테이너는 이와 달리 OS를 가상화하여 여러 개의 컨테이너를 OS 커널에서 직접 실행합니다. 컨테이너는 기존의 가상화 기술보다 훨씬 가볍게 동작하며, OS 커널을 공유하고, 시작 시간이나 종료 시간이 빠르고 ,  메모리를 훨씬 적게 차지합니다.

 컨테이너는 가상 머신과 마찬가지로 애플리케이션을 관련 라이브러리 및 종속 항목과 함께 패키지로 묶어 소프트웨어 서비스를 위한 환경을 분리할 수 있도록 해줍니다. 가상화 기술과 컨테이너 기술이  유사점은 여기까지입니다. 컨테이너를 사용하면 개발자와 IT 운영팀이 훨씬 작은 단위로 업무를 수행할 수 있어이점이 훨씬 많습니다.
```



## 역할 별로 살펴보는 쿠버네티스 도입의 이유

### 기획자 측면에서 쿠버네티스 장점

| **기획자 측면의 장점**          |                                                              |
| :------------------------------ | ------------------------------------------------------------ |
| 특징                            | 설명                                                         |
| 디지털 트랜스포메이션 기반 구축 | 디지털트랜스 포메이션이 실현하려면 IT 서비스 개발과 개선 ‘속도’가 비즈니스 우위를 확보하기 위한 필수적인 조건 |
| 비용 절감                       | 높은 시스템 자원 사용율에 따른 비용 절감                     |
|                                 | Guest OS 에 대한 라이선스 제거                               |
|                                 | Guest OS 유지보수비용 및 관리비용 제거                       |
| 하이브리드 클라우드 실현        | Private 클라우드 구축하여 Public 클라우드로 즉시 이전 가능   |
|                                 | Private Cloud 와 Public Cloud 를 단일한 기술과 운영 방법으로 관리 |
|                                 | 컨테이너를 기반으로 하는 오픈소스이기 때문에 사용자들이 특정 업체에 종속되지 않고 클라우드의 환경들을 이전 |
| DevOps 기반                     | 컨테이너는 DevOps 빌드/테스트/배포 파이프라인을 간소화       |



### 개발자 측면에서 쿠버네티스 장점

| **개발자 측면의 장점**  |                                                              |
| :---------------------- | ------------------------------------------------------------ |
| 특징                    | 설명                                                         |
| 효율적인 개발환경 구축  | 개발환경 구축 기간 단축 / OS가상화로 격리된 테스트 환경 구축 |
|                         | 기존 가상화 대비 작은 시스템 리소스로 개발 환경 구축         |
| 배포 편이성             | 이미지를 통한 빌드, 배포 자동화                              |
|                         | 개발자 환경/테스트 환경/스테이징 환경/운영 환경에 대한 일관성 보장으로 장애 요인 제거와 장애 원인 파악 시간 단축 |
| 민첩한 개발             | 컨테이너를 통한 짧은 주기로 요구사항 정의와 릴리즈를 반복하는 Agile Development 지원 |
| 서비스 무정지 환경 제공 | 서비스 정지 없이 시스템 운영이 가능하여 배포시간과 횟수에 대한 제약이 없음 |
| 마이크로서비스 아키텍처 | 마이크로 서비스는 컨테이너로 구성하고 배포, 운영하는 것이 매우 유리 |
| DevOps 기반             | 컨테이너는 DevOps 빌드/테스트/배포 파이프라인을 간소화       |



### 운영자 측면에서 쿠버네티스 장점

| **운영자 측면의 장점**           |                                                              |
| :------------------------------- | ------------------------------------------------------------ |
| 특징                             | 설명                                                         |
| 낮은 오버헤드와 빠른 시작        | 최소한의 CPU와 메모리 만 사용하여 비용절감과 부하가 작아 고성능 제공 |
|                                  | Guest OS 가 없기 때문에 OS 부팅 없이 애플리케이션을 실행하여 빠른 시작 (호스트 OS 에서 프로세스로 실행) |
| 높은 이동성 ( Portability)       | Public Cloud (AWS, Azure, Google …)와 기업 내 에서 Linux 운영체제라면 어디서나 운영 및 이식이 용이함 |
| 구축 기간 단축                   | 컨테이너 환경은 개발, 스테이징, 운영 환경을 단순한 복사로 구축하여 작업시간을 단축하고 일관성을 제공하여 환경에 의한 문제 원인 제거 |
| 장애 대응                        | 배포, 시스템 유지보수, 장애 발생시 무정지 작업이 가능        |
|                                  | 컨터이너 이미지 단위로 배포하고 운영하기 때문에 장애시 전환 시간을 단축 |
|                                  | 이미지 형태의 배포로 환경 차이에 의한 장애원인 제거          |
| 클라우드 네이티브 운영 환경 실현 | 스케쥴링(Scheduling), 컨트롤링(Controlling) , 자가 복구(Self Healing), 오토 스케일링(Auto Scaling), 롤링 업데이트(Rolling Update) |



# openshift와  kubernetes 차이점

![ocp4](/Users/jaesuk.lee/Documents/GitHub/openshift4/service Mesh/image/ocp4.png)

1. 신뢰할 수 있는 OS 기반 : RHEL CoreOS / RHEL

    20년 이상 비즈니스 어플리케이션을 위한 Linux 

   다양한 프로덕션 환경에서 컨테이너를 실행하기 위한 다양한 경험 

   다양한 산업군에서 두루 사용 

​       RHEL coreOS 권장

       ```
       RHEL 은 동일한 커널 공유 
       kuernetes 클러스터를 대규모로 관리하는데 최적화 되어 있음 
       설치 공간을 최소화 하여  클러스터 설치 노드 클러스터 설치
       워커노드들의 auto-scaling, auto-remediation 조작을 쉽게 할 수 있도록 지원 
       ```



2. 자동화 된 작업

​       어플리케이선 및 솔루션을 보다 쉽게 설치하기 위한  operator hub 및 develop catalog 제공      ![operatorhub](/Users/jaesuk.lee/Documents/GitHub/openshift4/service Mesh/image/operatorhub.png)



3. 개발자 서비스

​      개발자 전용 UI 제공          ![dev](/Users/jaesuk.lee/Documents/GitHub/openshift4/service Mesh/image/dev.png)

    ```
    git, registry, Dockerfile, build 정보, 
    service, deployment, router, pod 등의 서비스 구성 정보 
    배포된 응용프로그램 시각화 
    ```

​      Openshift에 내제하여 컨테이어 화된 웹 IDE (codeready workspaces)

![codeready](/Users/jaesuk.lee/Documents/GitHub/openshift4/service Mesh/image/codeready.png)

```
openshift container platrom에는. jenkins 또는 Teckon을 제공
openshift console과 통합하여 파이프라인을 트리거 가능 
배포등 확인 가능 
```



4. 응용 서비스

마이크로서비스 와  서버리스 등의 최신 아키텍어를 지원 

Service Mech : Istio, kiali 및 Jaeger를 기본 제공 

Serverless: native, keda 제공 

![kiali-1](/Users/jaesuk.lee/Documents/GitHub/openshift4/service Mesh/image/kiali-1.png)

![kiali-2](/Users/jaesuk.lee/Documents/GitHub/openshift4/service Mesh/image/kiali-2.png)



5. 클러스터 서비스

모니터링 : Prometheus, grafana, alertmanager

 로그 관리: ElasticSearch, kebab, flaunted

 인증 및 권한: Oauth (LDAP, Active Directory, OpenID connect등)

 네트워킹 open vswitch 

![da1](/Users/jaesuk.lee/Documents/GitHub/openshift4/service Mesh/image/da1.png)

 ![da2](/Users/jaesuk.lee/Documents/GitHub/openshift4/service Mesh/image/da2.png)

